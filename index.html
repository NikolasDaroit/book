<!DOCTYPE html>
<html lang="en">
<head>
<link rel="manifest" href="/manifest.json">
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Spell Cards</title>
<style>
    body {
        font-family: Arial, sans-serif;
    }
    #searchInput, .filter-section {
        margin: 20px 0;
    }
    .filter-item {
        margin-right: 15px;
    }
    .card {
        border: 1px solid #ccc;
        border-radius: 5px;
        padding: 20px;
        margin: 10px 0;
        background-color: #f9f9f9;
    }
    .title {
        color: #333;
        font-size: 20px;
    }
    .subtitle, .property, .text {
        margin: 5px 0;
    }
    .rule {
        border: none;
        border-top: 1px solid #aaa;
        margin: 10px 0;
    }
</style>
</head>
<body>

<input type="text" id="searchInput" placeholder="Search for spells...">

<div class="filter-section">
    <!-- Checkboxes will be inserted here by JavaScript -->
</div>

<div id="cardsContainer"></div>

<script>
    const spells = [
	{
		"count": 1,
		"color": "#4a6898",
		"title": "Sapping Sting",
		"icon": "magic-swirl",
		"icon_back": "magic-swirl",
		"contents": [
			"subtitle | Necromancy cantrip",
			"rule",
			"property | Casting Time | 1 action",
			"property | Range | 30 feet",
			"property | Components | V, S",
			"property | Duration | Instantaneous",
			"rule",
			"text | You sap the vitality of one creature you can see in range. The target must succeed on a Constitution saving throw or take 1d4 necrotic damage and fall prone.",
			"text | This spell's damage increases by 1d4 when you reach 5th level (2d4), 11th level (3d4), and 17th level (4d4)."
		],
		"tags": [
			"spell",
			"EGW",
			"Cantrips",
			"Necromancy"
		]
	},
	{
		"count": 1,
		"color": "#4a6898",
		"title": "Gift of Alacrity",
		"icon": "magic-swirl",
		"icon_back": "magic-swirl",
		"contents": [
			"subtitle | 1st-level divination",
			"rule",
			"property | Casting Time | 1 minute",
			"property | Range | Touch",
			"property | Components | V, S",
			"property | Duration | 8 hours",
			"rule",
			"text | You touch a willing creature. For the duration, the target can add 1d8 to its initiative rolls."
		],
		"tags": [
			"spell",
			"EGW",
			"1st level",
			"Divination"
		]
	},
	{
		"count": 1,
		"color": "#4a6898",
		"title": "Fortune's Favor",
		"icon": "magic-swirl",
		"icon_back": "magic-swirl",
		"contents": [
			"subtitle | 2nd-level divination",
			"rule",
			"property | Casting Time | 1 minute",
			"property | Range | 60 feet",
			"property | Components | V, S, M (a white pearl worth at least 100 gp, which the spell consumes)",
			"property | Duration | 1 hour",
			"rule",
			"text | You impart latent luck to yourself or one willing creature you can see within range. When the chosen creature makes an attack roll, an ability check, or a saving throw before the spell ends, it can dismiss this spell on itself to roll an additional d20 and choose which of the d20s to use. Alternatively, when an attack roll is made against the chosen creature, it can dismiss this spell on itself to roll a d20 and choose which of the d20s to use, the one it rolled or the one the attacker rolled.",
			"text | If the original d20 roll has advantage or disadvantage, the creature rolls the additional d20 after advantage or disadvantage has been applied to the original roll.",
			"section | At higher levels",
			"text | When you cast this spell using a spell slot of 3rd level or higher, you can target one additional creature for each slot level above 2nd."
		],
		"tags": [
			"spell",
			"EGW",
			"2nd level",
			"Divination"
		]
	},
	{
		"count": 1,
		"color": "#4a6898",
		"title": "Wristpocket",
		"icon": "magic-swirl",
		"icon_back": "magic-swirl",
		"contents": [
			"subtitle | 2nd-level conjuration (ritual)",
			"rule",
			"property | Casting Time | 1 action",
			"property | Range | Self",
			"property | Components | S",
			"property | Duration | Concentration, up to 1 hour",
			"rule",
			"text | You flick your wrist, causing one object in your hand to vanish. The object, which only you can be holding and can weigh no more than 5 pounds, is transported to an extradimensional space, where it remains for the duration.",
			"text | Until the spell ends, you can use your action to summon the object to your free hand, and you can use your action to return the object to the extradimensional space. An object still in the pocket plane when the spell ends appears in your space, at your feet."
		],
		"tags": [
			"spell",
			"EGW",
			"2nd level",
			"Conjuration",
			"concentration",
			"ritual"
		]
	},
	{
		"count": 1,
		"color": "#4a6898",
		"title": "Pulse Wave",
		"icon": "magic-swirl",
		"icon_back": "magic-swirl",
		"contents": [
			"subtitle | 3rd-level evocation",
			"rule",
			"property | Casting Time | 1 action",
			"property | Range | Self (30-foot cone)",
			"property | Components | V, S",
			"property | Duration | Instantaneous",
			"rule",
			"text | You create intense pressure, unleash it in a 30-foot cone, and decide whether the pressure pulls or pushes creatures and objects. Each creature in that cone must make a Constitution saving throw. A creature takes 6d6 force damage on a failed save, or half as much damage on a successful one. And every creature that fails the save is either pulled 15 feet toward you or pushed 15 feet away from you, depending on the choice you made for the spell.",
			"text | In addition, unsecured objects that are completely within the cone are likewise pulled or pushed 15 feet.",
			"section | At higher levels",
			"text | When you cast this spell using a spell slot of 4th level or higher, the damage increases by 1d6 and the distance pulled or pushed increases by 5 feet for each slot level above 3rd."
		],
		"tags": [
			"spell",
			"EGW",
			"3rd level",
			"Evocation"
		]
	},
	{
		"count": 1,
		"color": "#4a6898",
		"title": "Temporal Shunt",
		"icon": "magic-swirl",
		"icon_back": "magic-swirl",
		"contents": [
			"subtitle | 5th-level transmutation",
			"rule",
			"property | Casting Time | 1 reaction, taken when a creature you can see makes an attack roll or starts to cast a spell",
			"property | Range | 120 feet",
			"property | Components | V, S",
			"property | Duration | 1 round",
			"rule",
			"text | You target the triggering creature, which must succeed on a Wisdom saving throw or vanish, being thrown to another point in time and causing the attack to miss or the spell to be wasted. At the start of its next turn, the target reappears where it was or in the closest unoccupied space. The target doesn't remember you casting the spell or being affected by it.",
			"section | At higher levels",
			"text | When you cast this spell using a spell slot of 6th level or higher, you can target one additional creature for each slot level above 5th. All targets must be within 30 feet of each other."
		],
		"tags": [
			"spell",
			"EGW",
			"5th level",
			"Transmutation"
		]
	},
	{
		"count": 1,
		"color": "#4a6898",
		"title": "Absorb Elements",
		"icon": "magic-swirl",
		"icon_back": "magic-swirl",
		"contents": [
			"subtitle | 1st-level abjuration",
			"rule",
			"property | Casting Time | 1 reaction, which you take when you take acid, cold, fire, lightning, or thunder damage",
			"property | Range | Self",
			"property | Components | S",
			"property | Duration | 1 round",
			"rule",
			"text | The spell captures some of the incoming energy, lessening its effect on you and storing it for your next melee attack. You have resistance to the triggering damage type until the start of your next turn. Also, the first time you hit with a melee attack on your next turn, the target takes an extra 1d6 damage of the triggering type, and the spell ends.",
			"section | At higher levels",
			"text | When you cast this spell using a spell slot of 2nd level or higher, the extra damage increases by 1d6 for each slot level above 1st."
		],
		"tags": [
			"spell",
			"XGE",
			"1st level",
			"Abjuration",
			"Druid",
			"Ranger",
			"Sorcerer",
			"Wizard",
			"Artificer"
		]
	},
	{
		"count": 1,
		"color": "#4a6898",
		"title": "Shield",
		"icon": "magic-swirl",
		"icon_back": "magic-swirl",
		"contents": [
			"subtitle | 1st-level abjuration",
			"rule",
			"property | Casting Time | 1 reaction, which you take when you are hit by an attack or targeted by the <a href=\"spells.html#magic%20missile_phb\"  onmouseover=\"Renderer.hover.pHandleLinkMouseOver(event, this)\" onmouseleave=\"Renderer.hover.handleLinkMouseLeave(event, this)\" onmousemove=\"Renderer.hover.handleLinkMouseMove(event, this)\" data-vet-page=\"spells.html\" data-vet-source=\"PHB\" data-vet-hash=\"magic%20missile_phb\"   ontouchstart=\"Renderer.hover.handleTouchStart(event, this)\" >magic missile</a> spell",
			"property | Range | Self",
			"property | Components | V, S",
			"property | Duration | 1 round",
			"rule",
			"text | An invisible barrier of magical force appears and protects you. Until the start of your next turn, you have a +5 bonus to AC, including against the triggering attack, and you take no damage from magic missile."
		],
		"tags": [
			"spell",
			"PHB",
			"1st level",
			"Abjuration",
			"Sorcerer",
			"Wizard"
		]
	},
	{
		"count": 1,
		"color": "#4a6898",
		"title": "Feather Fall",
		"icon": "magic-swirl",
		"icon_back": "magic-swirl",
		"contents": [
			"subtitle | 1st-level transmutation",
			"rule",
			"property | Casting Time | 1 reaction, which you take when you or a creature within 60 feet of you falls",
			"property | Range | 60 feet",
			"property | Components | V, M (a small feather or a piece of down)",
			"property | Duration | 1 minute",
			"rule",
			"text | Choose up to five falling creatures within range. A falling creature's rate of descent slows to 60 feet per round until the spell ends. If the creature lands before the spell ends, it takes no falling damage and can land on its feet, and the spell ends for that creature."
		],
		"tags": [
			"spell",
			"PHB",
			"1st level",
			"Transmutation",
			"Bard",
			"Sorcerer",
			"Wizard",
			"Artificer"
		]
	},
	{
		"count": 1,
		"color": "#4a6898",
		"title": "Protection from Evil and Good",
		"icon": "magic-swirl",
		"icon_back": "magic-swirl",
		"contents": [
			"subtitle | 1st-level abjuration",
			"rule",
			"property | Casting Time | 1 action",
			"property | Range | Touch",
			"property | Components | V, S, M (holy water or powdered silver and iron, which the spell consumes)",
			"property | Duration | Concentration, up to 10 minutes",
			"rule",
			"text | Until the spell ends, one willing creature you touch is protected against certain types of creatures: aberrations, celestials, elementals, fey, fiends, and undead.",
			"text | The protection grants several benefits. Creatures of those types have disadvantage on attack rolls against the target. The target also can't be charmed, frightened, or possessed by them. If the target is already charmed, frightened, or possessed by such a creature, the target has advantage on any new saving throw against the relevant effect."
		],
		"tags": [
			"spell",
			"PHB",
			"1st level",
			"Abjuration",
			"Cleric",
			"Paladin",
			"Warlock",
			"Wizard",
			"Druid",
			"concentration"
		]
	},
	{
		"count": 1,
		"color": "#4a6898",
		"title": "Greater Invisibility",
		"icon": "magic-swirl",
		"icon_back": "magic-swirl",
		"contents": [
			"subtitle | 4th-level illusion",
			"rule",
			"property | Casting Time | 1 action",
			"property | Range | Touch",
			"property | Components | V, S",
			"property | Duration | Concentration, up to 1 minute",
			"rule",
			"text | You or a creature you touch becomes invisible until the spell ends. Anything the target is wearing or carrying is invisible as long as it is on the target's person."
		],
		"tags": [
			"spell",
			"PHB",
			"4th level",
			"Illusion",
			"Bard",
			"Sorcerer",
			"Wizard",
			"concentration"
		]
	},
	{
		"count": 1,
		"color": "#4a6898",
		"title": "Misty Step",
		"icon": "magic-swirl",
		"icon_back": "magic-swirl",
		"contents": [
			"subtitle | 2nd-level conjuration",
			"rule",
			"property | Casting Time | 1 bonus action",
			"property | Range | Self",
			"property | Components | V",
			"property | Duration | Instantaneous",
			"rule",
			"text | Briefly surrounded by silvery mist, you teleport up to 30 feet to an unoccupied space that you can see."
		],
		"tags": [
			"spell",
			"PHB",
			"2nd level",
			"Conjuration",
			"Sorcerer",
			"Warlock",
			"Wizard"
		]
	},
	{
		"count": 1,
		"color": "#4a6898",
		"title": "Dimension Door",
		"icon": "magic-swirl",
		"icon_back": "magic-swirl",
		"contents": [
			"subtitle | 4th-level conjuration",
			"rule",
			"property | Casting Time | 1 action",
			"property | Range | 500 feet",
			"property | Components | V",
			"property | Duration | Instantaneous",
			"rule",
			"text | You teleport yourself from your current location to any other spot within range. You arrive at exactly the spot desired. It can be a place you can see, one you can visualize, or one you can describe by stating distance and direction, such as \"200 feet straight downward\" or \"upward to the northwest at a 45-degree angle, 300 feet.\"",
			"text | You can bring along objects as long as their weight doesn't exceed what you can carry. You can also bring one willing creature of your size or smaller who is carrying gear up to its carrying capacity. The creature must be within 5 feet of you when you cast this spell.",
			"text | If you would arrive in a place already occupied by an object or a creature, you and any creature traveling with you each take 4d6 force damage, and the spell fails to teleport you."
		],
		"tags": [
			"spell",
			"PHB",
			"4th level",
			"Conjuration",
			"Bard",
			"Sorcerer",
			"Warlock",
			"Wizard"
		]
	},
	{
		"count": 1,
		"color": "#4a6898",
		"title": "Passwall",
		"icon": "magic-swirl",
		"icon_back": "magic-swirl",
		"contents": [
			"subtitle | 5th-level transmutation",
			"rule",
			"property | Casting Time | 1 action",
			"property | Range | 30 feet",
			"property | Components | V, S, M (a pinch of sesame seeds)",
			"property | Duration | 1 hour",
			"rule",
			"text | A passage appears at a point of your choice that you can see on a wooden, plaster, or stone surface (such as a wall, a ceiling, or a floor) within range, and lasts for the duration. You choose the opening's dimensions: up to 5 feet wide, 8 feet tall, and 20 feet deep. The passage creates no instability in a structure surrounding it.",
			"text | When the opening disappears, any creatures or objects still in the passage created by the spell are safely ejected to an unoccupied space nearest to the surface on which you cast the spell."
		],
		"tags": [
			"spell",
			"PHB",
			"5th level",
			"Transmutation",
			"Wizard"
		]
	},
	{
		"count": 1,
		"color": "#4a6898",
		"title": "Earthbind",
		"icon": "magic-swirl",
		"icon_back": "magic-swirl",
		"contents": [
			"subtitle | 2nd-level transmutation",
			"rule",
			"property | Casting Time | 1 action",
			"property | Range | 300 feet",
			"property | Components | V",
			"property | Duration | Concentration, up to 1 minute",
			"rule",
			"text | Choose one creature you can see within range. Yellow strips of magical energy loop around the creature. The target must succeed on a Strength saving throw, or its flying speed (if any) is reduced to 0 feet for the spell's duration. An airborne creature affected by this spell safely descends at 60 feet per round until it reaches the ground or the spell ends."
		],
		"tags": [
			"spell",
			"XGE",
			"2nd level",
			"Transmutation",
			"Druid",
			"Sorcerer",
			"Warlock",
			"Wizard",
			"concentration"
		]
	},
	{
		"count": 1,
		"color": "#4a6898",
		"title": "Tasha's Mind Whip",
		"icon": "magic-swirl",
		"icon_back": "magic-swirl",
		"contents": [
			"subtitle | 2nd-level enchantment",
			"rule",
			"property | Casting Time | 1 action",
			"property | Range | 90 feet",
			"property | Components | V",
			"property | Duration | 1 round",
			"rule",
			"text | You psychically lash out at one creature you can see within range. The target must make an Intelligence saving throw. On a failed save, the target takes 3d6 psychic damage, and it can't take a reaction until the end of its next turn. Moreover, on its next turn, it must choose whether it gets a move, an action, or a bonus action; it gets only one of the three. On a successful save, the target takes half as much damage and suffers none of the spell's other effects.",
			"section | At higher levels",
			"text | When you cast this spell using a spell slot of 3rd level or higher, you can target one additional creature for each slot level above 2nd. The creatures must be within 30 feet of each other when you target them."
		],
		"tags": [
			"spell",
			"TCE",
			"2nd level",
			"Enchantment",
			"Sorcerer",
			"Wizard"
		]
	},
	{
		"count": 1,
		"color": "#4a6898",
		"title": "Sickening Radiance",
		"icon": "magic-swirl",
		"icon_back": "magic-swirl",
		"contents": [
			"subtitle | 4th-level evocation",
			"rule",
			"property | Casting Time | 1 action",
			"property | Range | 120 feet",
			"property | Components | V, S",
			"property | Duration | Concentration, up to 10 minutes",
			"rule",
			"text | Dim, greenish light spreads within a 30-foot-radius sphere centered on a point you choose within range. The light spreads around corners, and it lasts until the spell ends.",
			"text | When a creature moves into the spell's area for the first time on a turn or starts its turn there, that creature must succeed on a Constitution saving throw or take 4d10 radiant damage, and it suffers one level of exhaustion and emits a dim, greenish light in a 5-foot radius. This light makes it impossible for the creature to benefit from being invisible. The light and any levels of exhaustion caused by this spell go away when the spell ends."
		],
		"tags": [
			"spell",
			"XGE",
			"4th level",
			"Evocation",
			"Sorcerer",
			"Warlock",
			"Wizard",
			"concentration"
		]
	},
	{
		"count": 1,
		"color": "#4a6898",
		"title": "Shatter",
		"icon": "magic-swirl",
		"icon_back": "magic-swirl",
		"contents": [
			"subtitle | 2nd-level transmutation",
			"rule",
			"property | Casting Time | 1 action",
			"property | Range | 60 feet",
			"property | Components | V, S, M (a chip of mica)",
			"property | Duration | Instantaneous",
			"rule",
			"text | A sudden loud ringing noise, painfully intense, erupts from a point of your choice within range. Each creature in a 10-foot-radius sphere centered on that point must make a Constitution saving throw. A creature takes 3d8 thunder damage on a failed save, or half as much damage on a successful one. A creature made of inorganic material such as stone, crystal, or metal has disadvantage on this saving throw.",
			"text | A nonmagical object that isn't being worn or carried also takes the damage if it's in the spell's area.",
			"section | At higher levels",
			"text | When you cast this spell using a spell slot of 3rd level or higher, the damage increases by 1d8 for each slot level above 2nd."
		],
		"tags": [
			"spell",
			"XUA22CRS",
			"2nd level",
			"Transmutation",
			"Bard",
			"Sorcerer",
			"Warlock",
			"Wizard"
		]
	},
	{
		"count": 1,
		"color": "#4a6898",
		"title": "Steel Wind Strike",
		"icon": "magic-swirl",
		"icon_back": "magic-swirl",
		"contents": [
			"subtitle | 5th-level conjuration",
			"rule",
			"property | Casting Time | 1 action",
			"property | Range | 30 feet",
			"property | Components | S, M (a melee weapon worth at least 1 sp)",
			"property | Duration | Instantaneous",
			"rule",
			"text | You flourish the weapon used in the casting and then vanish to strike like the wind. Choose up to five creatures you can see within range. Make a melee spell attack against each target. On a hit, a target takes 6d10 force damage.",
			"text | You can then teleport to an unoccupied space you can see within 5 feet of one of the targets you hit or missed."
		],
		"tags": [
			"spell",
			"XGE",
			"5th level",
			"Conjuration",
			"Ranger",
			"Wizard"
		]
	},
	{
		"count": 1,
		"color": "#4a6898",
		"title": "Synaptic Static",
		"icon": "magic-swirl",
		"icon_back": "magic-swirl",
		"contents": [
			"subtitle | 5th-level enchantment",
			"rule",
			"property | Casting Time | 1 action",
			"property | Range | 120 feet",
			"property | Components | V, S",
			"property | Duration | Instantaneous",
			"rule",
			"text | You choose a point within range and cause psychic energy to explode there. Each creature in a 20-foot-radius sphere centered on that point must make an Intelligence saving throw. A creature with an Intelligence score of 2 or lower can't be affected by this spell. A target takes 8d6 psychic damage on a failed save, or half as much damage on a successful one.",
			"text | After a failed save, a target has muddled thoughts for 1 minute. During that time, it rolls a d6 and subtracts the number rolled from all its attack rolls and ability checks, as well as its Constitution saving throws to maintain concentration. The target can make an Intelligence saving throw at the end of each of its turns, ending the effect on itself on a success."
		],
		"tags": [
			"spell",
			"XGE",
			"5th level",
			"Enchantment",
			"Bard",
			"Sorcerer",
			"Warlock",
			"Wizard"
		]
	},
	{
		"count": 1,
		"color": "#4a6898",
		"title": "Detect Magic",
		"icon": "magic-swirl",
		"icon_back": "magic-swirl",
		"contents": [
			"subtitle | 1st-level divination (ritual)",
			"rule",
			"property | Casting Time | 1 action",
			"property | Range | Self",
			"property | Components | V, S",
			"property | Duration | Concentration, up to 10 minutes",
			"rule",
			"text | For the duration, you sense the presence of magic within 30 feet of you. If you sense magic in this way, you can use your action to see a faint aura around any visible creature or object in the area that bears magic, and you learn its school of magic, if any.",
			"text | The spell can penetrate most barriers, but it is blocked by 1 foot of stone, 1 inch of common metal, a thin sheet of lead, or 3 feet of wood or dirt."
		],
		"tags": [
			"spell",
			"PHB",
			"1st level",
			"Divination",
			"Bard",
			"Cleric",
			"Druid",
			"Paladin",
			"Ranger",
			"Sorcerer",
			"Wizard",
			"Artificer",
			"concentration",
			"ritual"
		]
	},
	{
		"count": 1,
		"color": "#4a6898",
		"title": "Find Familiar",
		"icon": "magic-swirl",
		"icon_back": "magic-swirl",
		"contents": [
			"subtitle | 1st-level conjuration (ritual)",
			"rule",
			"property | Casting Time | 1 hour",
			"property | Range | 10 feet",
			"property | Components | V, S, M (10 GP worth of charcoal, incense, and herbs that must be consumed by fire in a brass brazier)",
			"property | Duration | Instantaneous",
			"rule",
			"text | You gain the service of an otherworldly spirit, which manifests as a little animal in an unoccupied space of your choice within range.",
			"text | This creature uses the Otherworldly Familiar stat block. If you already have a familiar from this spell, that familiar transforms into the new one but retains its memories; you don't get a second familiar.",
			"text | Whenever you cast the spell, choose the familiar's creature type: Celestial, Fey, or Fiend.",
			"text | Also choose an environment: Air, Land, or Water.",
			"text | The familiar resembles a Tiny animal of your choice—such as an owl, a cat, or a frog—that is native to the chosen environment. Both choices—creature type and environment—determine certain traits in the stat block.",
			"description | Combat | The familiar is an ally to you and your companions. In combat, it shares your initiative count, but it takes its turn immediately after yours. It obeys your commands (no action required by you), but the familiar can't attack unless you use your Reaction on its turn to command it do so.",
			"text | If you don't issue any commands, the familiar takes the Dodge action and uses its Move to avoid danger.",
			"description | Disappearance of the Familiar | The familiar disappears if it drops to 0 Hit Points, if you dismiss it as a Bonus Action, or if you die. When it disappears, it leaves behind anything it was wearing or carrying. If you cast this spell again, you decide whether you summon the familiar that disappeared or a different one.",
			"description | Remote Viewing | As a Magic action, you can see what your familiar sees and hear what it hears until the end of your next turn.",
			"section | At higher levels",
			"text | When you cast this spell using a Spell Slot of 2nd level or higher, use the higher level wherever the spell's level appears in the stat block."
		],
		"tags": [
			"spell",
			"XUA23DP",
			"1st level",
			"Conjuration",
			"ritual"
		]
	},
	{
		"count": 1,
		"color": "#4a6898",
		"title": "Counterspell",
		"icon": "magic-swirl",
		"icon_back": "magic-swirl",
		"contents": [
			"subtitle | 3rd-level abjuration",
			"rule",
			"property | Casting Time | 1 reaction, which you take when you see a creature within 60 feet of you casting a spell",
			"property | Range | 60 feet",
			"property | Components | S",
			"property | Duration | Instantaneous",
			"rule",
			"text | You attempt to interrupt a creature in the process of casting a spell. If the creature is casting a spell of 3rd level or lower, its spell fails and has no effect. If it is casting a spell of 4th level or higher, make an ability check using your spellcasting ability. The DC equals 10 + the spell's level. On a success, the creature's spell fails and has no effect.",
			"section | At higher levels",
			"text | When you cast this spell using a spell slot of 4th level or higher, the interrupted spell has no effect if its level is less than or equal to the level of the spell slot you used."
		],
		"tags": [
			"spell",
			"PHB",
			"3rd level",
			"Abjuration",
			"Sorcerer",
			"Warlock",
			"Wizard"
		]
	},
	{
		"count": 1,
		"color": "#4a6898",
		"title": "Vortex Warp",
		"icon": "magic-swirl",
		"icon_back": "magic-swirl",
		"contents": [
			"subtitle | 2nd-level conjuration",
			"rule",
			"property | Casting Time | 1 action",
			"property | Range | 90 feet",
			"property | Components | V, S",
			"property | Duration | Instantaneous",
			"rule",
			"text | You magically twist space around another creature you can see within range. The target must succeed on a Constitution saving throw (the target can choose to fail), or the target is teleported to an unoccupied space of your choice that you can see within range. The chosen space must be on a surface or in a liquid that can support the target without the target having to squeeze.",
			"section | At higher levels",
			"text | When you cast this spell using a spell slot of 3rd level or higher, the range of the spell increases by 30 feet for each slot level above 2nd."
		],
		"tags": [
			"spell",
			"SCC",
			"2nd level",
			"Conjuration",
			"Sorcerer",
			"Wizard",
			"Artificer"
		]
	},
	{
		"count": 1,
		"color": "#4a6898",
		"title": "Silvery Barbs",
		"icon": "magic-swirl",
		"icon_back": "magic-swirl",
		"contents": [
			"subtitle | 1st-level enchantment",
			"rule",
			"property | Casting Time | 1 reaction, which you take when a creature you can see within 60 feet of yourself succeeds on an attack roll, an ability check, or a saving throw",
			"property | Range | 60 feet",
			"property | Components | V",
			"property | Duration | Instantaneous",
			"rule",
			"text | You magically distract the triggering creature and turn its momentary uncertainty into encouragement for another creature. The triggering creature must reroll the d20 and use the lower roll.",
			"text | You can then choose a different creature you can see within range (you can choose yourself). The chosen creature has advantage on the next attack roll, ability check, or saving throw it makes within 1 minute. A creature can be empowered by only one use of this spell at a time."
		],
		"tags": [
			"spell",
			"SCC",
			"1st level",
			"Enchantment",
			"Bard",
			"Sorcerer",
			"Wizard"
		]
	},
	{
		"count": 1,
		"color": "#4a6898",
		"title": "Mage Hand",
		"icon": "magic-swirl",
		"icon_back": "magic-swirl",
		"contents": [
			"subtitle | Conjuration cantrip",
			"rule",
			"property | Casting Time | 1 action",
			"property | Range | 30 feet",
			"property | Components | V, S",
			"property | Duration | 1 minute",
			"rule",
			"text | A spectral, floating hand appears at a point you choose within range. The hand lasts for the duration or until you dismiss it as an action. The hand vanishes if it is ever more than 30 feet away from you or if you cast this spell again.",
			"text | You can use your action to control the hand. You can use the hand to manipulate an object, open an unlocked door or container, stow or retrieve an item from an open container, or pour the contents out of a vial. You can move the hand up to 30 feet each time you use it.",
			"text | The hand can't attack, activate magic items, or carry more than 10 pounds."
		],
		"tags": [
			"spell",
			"PHB",
			"Cantrips",
			"Conjuration",
			"Bard",
			"Sorcerer",
			"Warlock",
			"Wizard",
			"Artificer"
		]
	},
	{
		"count": 1,
		"color": "#4a6898",
		"title": "Fire Bolt",
		"icon": "magic-swirl",
		"icon_back": "magic-swirl",
		"contents": [
			"subtitle | Evocation cantrip",
			"rule",
			"property | Casting Time | 1 action",
			"property | Range | 120 feet",
			"property | Components | V, S",
			"property | Duration | Instantaneous",
			"rule",
			"text | You hurl a mote of fire at a creature or object within range. Make a ranged spell attack against the target. On a hit, the target takes 1d10 fire damage. A flammable object hit by this spell ignites if it isn't being worn or carried.",
			"text | This spell's damage increases by 1d10 when you reach 5th level (2d10), 11th level (3d10), and 17th level (4d10)."
		],
		"tags": [
			"spell",
			"PHB",
			"Cantrips",
			"Evocation",
			"Sorcerer",
			"Wizard",
			"Artificer"
		]
	},
	{
		"count": 1,
		"color": "#4a6898",
		"title": "Mind Sliver",
		"icon": "magic-swirl",
		"icon_back": "magic-swirl",
		"contents": [
			"subtitle | Enchantment cantrip",
			"rule",
			"property | Casting Time | 1 action",
			"property | Range | 60 feet",
			"property | Components | V",
			"property | Duration | 1 round",
			"rule",
			"text | You drive a disorienting spike of psychic energy into the mind of one creature you can see within range. The target must succeed on an Intelligence saving throw or take 1d6 psychic damage and subtract 1d4 from the next saving throw it makes before the end of your next turn.",
			"text | This spell's damage increases by 1d6 when you reach certain levels: 5th level (2d6), 11th level (3d6), and 17th level (4d6)."
		],
		"tags": [
			"spell",
			"TCE",
			"Cantrips",
			"Enchantment",
			"Sorcerer",
			"Warlock",
			"Wizard"
		]
	},
	{
		"count": 1,
		"color": "#4a6898",
		"title": "Fizban's Platinum Shield",
		"icon": "magic-swirl",
		"icon_back": "magic-swirl",
		"contents": [
			"subtitle | 6th-level abjuration",
			"rule",
			"property | Casting Time | 1 bonus action",
			"property | Range | 60 feet",
			"property | Components | V, S, M (a platinum-plated dragon scale, worth at least 500 gp)",
			"property | Duration | Concentration, up to 1 minute",
			"rule",
			"text | You create a field of silvery light that surrounds a creature of your choice within range (you can choose yourself). The field sheds dim light out to 5 feet. While surrounded by the field, a creature gains the following benefits:",
			"bullet | <b>text | Cover</b> The creature has half cover.",
			"bullet | <b>text | Damage Resistance</b> The creature has resistance to acid, cold, fire, lightning, and poison damage.",
			"bullet | <b>text | Evasion</b> If the creature is subjected to an effect that allows it to make a Dexterity saving throw to take only half damage, the creature instead takes no damage if it succeeds on the saving throw, and only half damage if it fails.",
			"text | As a bonus action on subsequent turns, you can move the field to another creature within 60 feet of the field."
		],
		"tags": [
			"spell",
			"FTD",
			"6th level",
			"Abjuration",
			"Sorcerer",
			"Wizard",
			"concentration"
		]
	},
	{
		"count": 1,
		"color": "#4a6898",
		"title": "Mending",
		"icon": "magic-swirl",
		"icon_back": "magic-swirl",
		"contents": [
			"subtitle | Transmutation cantrip",
			"rule",
			"property | Casting Time | 1 minute",
			"property | Range | Touch",
			"property | Components | V, S, M (two lodestones)",
			"property | Duration | Instantaneous",
			"rule",
			"text | This spell repairs a single break or tear in an object you touch, such as broken chain link, two halves of a broken key, a torn cloak, or a leaking wineskin. As long as the break or tear is no larger than 1 foot in any dimension, you mend it, leaving no trace of the former damage.",
			"text | This spell can physically repair a magic item or construct, but the spell can't restore magic to such an object."
		],
		"tags": [
			"spell",
			"PHB",
			"Cantrips",
			"Transmutation",
			"Bard",
			"Cleric",
			"Druid",
			"Sorcerer",
			"Wizard",
			"Artificer"
		]
	},
	{
		"count": 1,
		"color": "#4a6898",
		"title": "Prestidigitation",
		"icon": "magic-swirl",
		"icon_back": "magic-swirl",
		"contents": [
			"subtitle | Transmutation cantrip",
			"rule",
			"property | Casting Time | 1 action",
			"property | Range | 10 feet",
			"property | Components | V, S",
			"property | Duration | Up to 1 hour",
			"rule",
			"text | This spell is a minor magical trick that novice spellcasters use for practice. You create one of the following magical effects within range:",
			"bullet | You create an instantaneous, harmless sensory effect, such as a shower of sparks, a puff of wind, faint musical notes, or an odd odor.",
			"bullet | You instantaneously light or snuff out a candle, a torch, or a small campfire.",
			"bullet | You instantaneously clean or soil an object no larger than 1 cubic foot.",
			"bullet | You chill, warm, or flavor up to 1 cubic foot of nonliving material for 1 hour.",
			"bullet | You make a color, a small mark, or a symbol appear on an object or a surface for 1 hour.",
			"bullet | You create a nonmagical trinket or an illusory image that can fit in your hand and that lasts until the end of your next turn.",
			"text | If you cast this spell multiple times, you can have up to three of its non-instantaneous effects active at a time, and you can dismiss such an effect as an action."
		],
		"tags": [
			"spell",
			"PHB",
			"Cantrips",
			"Transmutation",
			"Bard",
			"Sorcerer",
			"Warlock",
			"Wizard",
			"Artificer"
		]
	},
	{
		"count": 1,
		"color": "#4a6898",
		"title": "Dispel Magic",
		"icon": "magic-swirl",
		"icon_back": "magic-swirl",
		"contents": [
			"subtitle | 3rd-level abjuration",
			"rule",
			"property | Casting Time | 1 action",
			"property | Range | 120 feet",
			"property | Components | V, S",
			"property | Duration | Instantaneous",
			"rule",
			"text | Choose one creature, object, or magical effect within range. Any spell of 3rd level or lower on the target ends. For each spell of 4th level or higher on the target, make an ability check using your spellcasting ability. The DC equals 10 + the spell's level. On a successful check, the spell ends.",
			"section | At higher levels",
			"text | When you cast this spell using a spell slot of 4th level or higher, you automatically end the effects of a spell on the target if the spell's level is equal to or less than the level of the spell slot you used."
		],
		"tags": [
			"spell",
			"PHB",
			"3rd level",
			"Abjuration",
			"Bard",
			"Cleric",
			"Druid",
			"Paladin",
			"Sorcerer",
			"Warlock",
			"Wizard",
			"Artificer"
		]
	},
	{
		"count": 1,
		"color": "#4a6898",
		"title": "Slow",
		"icon": "magic-swirl",
		"icon_back": "magic-swirl",
		"contents": [
			"subtitle | 3rd-level transmutation",
			"rule",
			"property | Casting Time | 1 action",
			"property | Range | 120 feet",
			"property | Components | V, S, M (a drop of molasses)",
			"property | Duration | Concentration, up to 1 minute",
			"rule",
			"text | You alter time around up to six creatures of your choice in a 40-foot cube within range. Each target must succeed on a Wisdom saving throw or be affected by this spell for the duration.",
			"text | An affected target's speed is halved, it takes a −2 penalty to AC and Dexterity saving throws, and it can't use reactions. On its turn, it can use either an action or a bonus action, not both. Regardless of the creature's abilities or magic items, it can't make more than one melee or ranged attack during its turn.",
			"text | If the creature attempts to cast a spell with a casting time of 1 action, roll a d20. On an 11 or higher, the spell doesn't take effect until the creature's next turn, and the creature must use its action on that turn to complete the spell. If it can't, the spell is wasted.",
			"text | A creature affected by this spell makes another Wisdom saving throw at the end of each of its turns. On a successful save, the effect ends for it."
		],
		"tags": [
			"spell",
			"PHB",
			"3rd level",
			"Transmutation",
			"Sorcerer",
			"Wizard",
			"Bard",
			"concentration"
		]
	},
	{
		"count": 1,
		"color": "#4a6898",
		"title": "Suffocate",
		"icon": "magic-swirl",
		"icon_back": "magic-swirl",
		"contents": [
			"subtitle | 3rd-level conjuration",
			"rule",
			"property | Casting Time | 1 action",
			"property | Range | 60 feet",
			"property | Components | V, S, M (a leather glove)",
			"property | Duration | Concentration, up to 1 minute",
			"rule",
			"text | You create a pair of grasping hands made from invisible forces. Make a spell attack against one creature that you can see within range. On a hit, the creature is restrained as the hands crush their throat or bodily equivalent.",
			"text | If the creature requires air to breathe, it begins to suffocate. A suffocating creature can survive for a number of rounds equal to 1 + its Constitution modifier (minimum of 1 round). At the start of its next turn after those rounds are over, it becomes unconscious, and it can't regain hit points until it can breathe again.",
			"text | A conscious creature restrained by the hands can use its action to make a Strength or Dexterity check (its choice) against your spell save DC. On a success, the spell ends on the target."
		],
		"tags": [
			"spell",
			"GHLoE",
			"3rd level",
			"Conjuration",
			"Bard",
			"Sorcerer",
			"Warlock",
			"Wizard",
			"concentration"
		]
	},
	{
		"count": 1,
		"color": "#4a6898",
		"title": "Phantom Steed",
		"icon": "magic-swirl",
		"icon_back": "magic-swirl",
		"contents": [
			"subtitle | 3rd-level illusion (ritual)",
			"rule",
			"property | Casting Time | 1 minute",
			"property | Range | 30 feet",
			"property | Components | V, S",
			"property | Duration | 1 hour",
			"rule",
			"text | A Large quasi-real, horselike creature appears on the ground in an unoccupied space of your choice within range. You decide the creature's appearance, but it is equipped with a saddle, bit, and bridle. Any of the equipment created by the spell vanishes in a puff of smoke if it is carried more than 10 feet away from the steed.",
			"text | For the duration, you or a creature you choose can ride the steed. The creature uses the statistics for a riding horse, except it has a speed of 100 feet and can travel 10 miles in an hour, or 13 miles at a fast pace. When the spell ends, the steed gradually fades, giving the rider 1 minute to dismount. The spell ends if you use an action to dismiss it or if the steed takes any damage."
		],
		"tags": [
			"spell",
			"PHB",
			"3rd level",
			"Illusion",
			"Wizard",
			"ritual"
		]
	},
	{
		"count": 1,
		"color": "#4a6898",
		"title": "Rary's Telepathic Bond",
		"icon": "magic-swirl",
		"icon_back": "magic-swirl",
		"contents": [
			"subtitle | 5th-level divination (ritual)",
			"rule",
			"property | Casting Time | 1 action",
			"property | Range | 30 feet",
			"property | Components | V, S, M (pieces of eggshell from two different kinds of creatures)",
			"property | Duration | 1 hour",
			"rule",
			"text | You forge a telepathic link among up to eight willing creatures of your choice within range, psychically linking each creature to all the others for the duration. Creatures with Intelligence scores of 2 or less aren't affected by this spell.",
			"text | Until the spell ends, the targets can communicate telepathically through the bond whether or not they have a common language. The communication is possible over any distance, though it can't extend to other planes of existence."
		],
		"tags": [
			"spell",
			"PHB",
			"5th level",
			"Divination",
			"Wizard",
			"Bard",
			"ritual"
		]
	},
	{
		"count": 1,
		"color": "#4a6898",
		"title": "True Strike",
		"icon": "magic-swirl",
		"icon_back": "magic-swirl",
		"contents": [
			"subtitle | Divination cantrip",
			"rule",
			"property | Casting Time | 1 action",
			"property | Range | Self",
			"property | Components | S, M (a weapon with which you have proficiency)",
			"property | Duration | Instantaneous",
			"rule",
			"text | Guided by a flash of magical insight, you make one attack with the weapon used in the spell's casting. The attack uses your spellcasting ability for the attack and damage rolls instead of using Strength or Dexterity. If the attack deals damage, it can be Radiant damage or the weapon's normal damage type (your choice).",
			"section | At higher levels",
			"description | Cantrip Upgrade | Whether you choose to deal Radiant damage or the weapon's normal damage type, the attack deals extra Radiant damage when you reach levels 5 (1d6), 11 (2d6), and 17 (3d6)."
		],
		"tags": [
			"spell",
			"XUA23BC",
			"Cantrips",
			"Divination"
		]
	},
	{
		"count": 1,
		"color": "#4a6898",
		"title": "Message",
		"icon": "magic-swirl",
		"icon_back": "magic-swirl",
		"contents": [
			"subtitle | Transmutation cantrip",
			"rule",
			"property | Casting Time | 1 action",
			"property | Range | 120 feet",
			"property | Components | V, S, M (a short piece of copper wire)",
			"property | Duration | 1 round",
			"rule",
			"text | You point your finger toward a creature within range and whisper a message. The target (and only the target) hears the message and can reply in a whisper that only you can hear.",
			"text | You can cast this spell through solid objects if you are familiar with the target and know it is beyond the barrier. Magical silence, 1 foot of stone, 1 inch of common metal, a thin sheet of lead, or 3 feet of wood blocks the spell. The spell doesn't have to follow a straight line and can travel freely around corners or through openings."
		],
		"tags": [
			"spell",
			"PHB",
			"Cantrips",
			"Transmutation",
			"Bard",
			"Sorcerer",
			"Wizard",
			"Artificer"
		]
	},
	{
		"count": 1,
		"color": "#4a6898",
		"title": "Jump",
		"icon": "magic-swirl",
		"icon_back": "magic-swirl",
		"contents": [
			"subtitle | 1st-level transmutation",
			"rule",
			"property | Casting Time | 1 action",
			"property | Range | Touch",
			"property | Components | V, S, M (a grasshopper's hind leg)",
			"property | Duration | 1 minute",
			"rule",
			"text | You touch a creature. The creature's jump distance is tripled until the spell ends."
		],
		"tags": [
			"spell",
			"PHB",
			"1st level",
			"Transmutation",
			"Druid",
			"Ranger",
			"Sorcerer",
			"Wizard",
			"Artificer"
		]
	},
	{
		"count": 1,
		"color": "#4a6898",
		"title": "Galder's Tower",
		"icon": "magic-swirl",
		"icon_back": "magic-swirl",
		"contents": [
			"subtitle | 3rd-level conjuration",
			"rule",
			"property | Casting Time | 10 minutes",
			"property | Range | 30 feet",
			"property | Components | V, S, M (a fragment of stone, wood, or other building material)",
			"property | Duration | 24 hours",
			"rule",
			"text | You conjure a two-story tower made of stone, wood, or similar suitably sturdy materials. The tower can be round or square in shape. Each level of the tower is 10 feet tall and has an area of up to 100 square feet. Access between levels consists of a simple ladder and hatch. Each level takes one of the following forms, chosen by you when you cast the spell:",
			"bullet | A bedroom with a bed, chairs, chest, and magical fireplace",
			"bullet | A study with desks, books, bookshelves, parchments, ink, and ink pens",
			"bullet | A dining space with a table, chairs, magical fireplace, containers, and cooking utensils",
			"bullet | A lounge with couches, armchairs, side tables and footstools",
			"bullet | A washroom with toilets, washtubs, a magical brazier, and sauna benches",
			"bullet | An observatory with a telescope and maps of the night sky",
			"bullet | An unfurnished, empty room",
			"text | The interior of the tower is warm and dry, regardless of conditions outside. Any equipment or furnishings conjured with the tower dissipate into smoke if removed from it. At the end of the spell's duration, all creatures and objects within the tower that were not created by the spell appear safely outside on the ground, and all traces of the tower and its furnishings disappear.",
			"text | You can cast this spell again while it is active to maintain the tower's existence for another 24 hours. You can create a permanent tower by casting this spell in the same location and with the same configuration every day for one year.",
			"section | At higher levels",
			"text | When you cast this spell using a spell slot of 4th level or higher, the tower can have one additional story for each slot level beyond 3rd."
		],
		"tags": [
			"spell",
			"LLK",
			"3rd level",
			"Conjuration",
			"Wizard"
		]
	},
	{
		"count": 1,
		"color": "#4a6898",
		"title": "Consume Mind",
		"icon": "magic-swirl",
		"icon_back": "magic-swirl",
		"contents": [
			"subtitle | 4th-level necromancy",
			"rule",
			"property | Casting Time | 1 action",
			"property | Range | Self",
			"property | Components | V, S, M (a 1-ounce fresh or magically preserved portion of another creature's brain)",
			"property | Duration | 1 hour",
			"rule",
			"text | You consume the brain of another creature's corpse, gaining its memories and knowledge. The corpse must have a brain and can't be undead. The spell fails if the corpse has been dead (and not preserved) for more than three days.",
			"text | Until the spell ends, you can attempt to recall any important fact known to the creature—family history, recent events, building layouts, passwords, details of the creature's death, and similar information. To recall a piece of information, you must make an ability check using your spellcasting modifier. The DC is equal to the corpse's Intelligence score.",
			"text | Once the caster rolls to determine whether they recall a fact, they cannot attempt to recall it again."
		],
		"tags": [
			"spell",
			"GHLoE",
			"4th level",
			"Necromancy",
			"Cleric",
			"Warlock",
			"Wizard"
		]
	},
	{
		"count": 1,
		"color": "#4a6898",
		"title": "Scrying",
		"icon": "magic-swirl",
		"icon_back": "magic-swirl",
		"contents": [
			"subtitle | 5th-level divination",
			"rule",
			"property | Casting Time | 10 minutes",
			"property | Range | Self",
			"property | Components | V, S, M (a focus worth at least 1,000 gp, such as a crystal ball, a silver mirror, or a font filled with holy water)",
			"property | Duration | Concentration, up to 10 minutes",
			"rule",
			"text | You can see and hear a particular creature you choose that is on the same plane of existence as you. The target must make a Wisdom saving throw, which is modified by how well you know the target and the sort of physical connection you have to it. If a target knows you're casting this spell, it can fail the saving throw voluntarily if it wants to be observed.",
			"text | <b>Knowledge of Target</b>",
			"text | Knowledge｜Save Modifier",
			"text | Secondhand (you have heard of the target)｜+5",
			"text | Firsthand (you have met the target)｜+0",
			"text | Familiar (you know the target well)｜-5",
			"text | <b>Connection to Target</b>",
			"text | Connection｜Save Modifier",
			"text | Likeness or picture｜-2",
			"text | Possession or garment｜-4",
			"text | Body part, lock of hair, bit of nail, or the like｜-10",
			"text | On a successful save, the target isn't affected, and you can't use this spell against it again for 24 hours.",
			"text | On a failed save, the spell creates an invisible sensor within 10 feet of the target. You can see and hear through the sensor as if you were there. The sensor moves with the target, remaining within 10 feet of it for the duration. A creature that can see invisible objects sees the sensor as a luminous orb about the size of your fist.",
			"text | Instead of targeting a creature, you can choose a location you have seen before as the target of this spell. When you do, the sensor appears at that location and doesn't move."
		],
		"tags": [
			"spell",
			"PHB",
			"5th level",
			"Divination",
			"Bard",
			"Cleric",
			"Druid",
			"Warlock",
			"Wizard",
			"concentration"
		]
	},
	{
		"count": 1,
		"color": "#4a6898",
		"title": "Geas",
		"icon": "magic-swirl",
		"icon_back": "magic-swirl",
		"contents": [
			"subtitle | 5th-level enchantment",
			"rule",
			"property | Casting Time | 1 minute",
			"property | Range | 60 feet",
			"property | Components | V",
			"property | Duration | 30 days",
			"rule",
			"text | You place a magical command on a creature that you can see within range, forcing it to carry out some service or refrain from some action or course of activity as you decide. If the creature can understand you, it must succeed on a Wisdom saving throw or become charmed by you for the duration. While the creature is charmed by you, it takes 5d10 psychic damage each time it acts in a manner directly counter to your instructions, but no more than once each day. A creature that can't understand you is unaffected by the spell.",
			"text | You can issue any command you choose, short of an activity that would result in certain death. Should you issue a suicidal command, the spell ends.",
			"text | You can end the spell early by using an action to dismiss it. A remove curse, greater restoration, or wish spell also ends it.",
			"section | At higher levels",
			"text | When you cast this spell using a spell slot of 7th or 8th level, the duration is 1 year. When you cast this spell using a spell slot of 9th level, the spell lasts until it is ended by one of the spells mentioned above."
		],
		"tags": [
			"spell",
			"PHB",
			"5th level",
			"Enchantment",
			"Bard",
			"Cleric",
			"Druid",
			"Paladin",
			"Wizard"
		]
	}
];
    
    function compareLevels(a, b) {
        if (a === "Cantrips") return -1;
        if (b === "Cantrips") return 1;
        const levelA = parseInt(a, 10);
        const levelB = parseInt(b, 10);
        return levelA - levelB;
    }

    function extractAndSortLevels(spells) {
        const levels = new Set();
        spells.forEach(spell => {
            spell.tags.forEach(tag => {
                const match = tag.match(/(\d+)(?:st|nd|rd|th) level|Cantrips/i);
                if (match) {
                    levels.add(match[0]);
                }
            });
        });
        return Array.from(levels).sort(compareLevels);
    }

    function createLevelCheckboxes(levels) {
        const container = document.querySelector('.filter-section');
        levels.forEach(level => {
            const label = document.createElement('label');
            label.className = 'filter-item';
            const formattedLevel = level.includes("level") ? level : level + " level"; // Ensure level text consistency
            label.innerHTML = `<input type="checkbox" class="levelFilter" value="${formattedLevel.toLowerCase()}"> ${formattedLevel}`;
            container.appendChild(label);
        });
    }
    function renderCards(spells) {
         // Sort spells by level, with cantrips first
        const sortedSpells = spells.sort((a, b) => {
            // Extract levels from tags
            const levelA = getSpellLevel(a.tags);
            const levelB = getSpellLevel(b.tags);

            // Compare levels for sorting
            return compareSpellLevels(levelA, levelB);
        });
        const container = document.getElementById('cardsContainer');
        container.innerHTML = ''; // Clear existing cards
        spells.forEach(spell => {
            const card = document.createElement('div');
            card.className = 'card';
            card.style.borderColor = spell.color;

            const title = document.createElement('div');
            title.className = 'title';
            title.innerHTML = spell.title; // Use innerHTML to allow for HTML formatting
            card.appendChild(title);

            spell.contents.forEach(content => {
                const element = document.createElement('div');

                // Format content for HTML
                let formattedContent = content
                    .replace(/<b>text \| Cover<\/b>|<b>Cover<\/b>/g, '<b>Cover</b>')
                    .replace(/(\bd\d+|\d+d\d+\b)/g, '<b>$1</b>') // Bold dice references
                    .replace(/<a\b[^>]*>(.*?)<\/a>/ig, "$1")
                    .replace(/\b(Strength|Dexterity|Constitution|Wisdom|Intelligence|Charisma)\b/g, '<b>$1</b>'); // Bold attributes
                
                if (formattedContent.indexOf('bullet') !== -1){
                    formattedContent = '<ul><li>' + formattedContent.replace('bullet |', '').replace('text | ', '') + '</li></ul>'
                }
                // Bold specific property titles and "At higher levels"
                const propertiesToBold = ['Casting Time', 'Range', 'Components', 'Duration', 'At higher levels'];
                propertiesToBold.forEach(prop => {
                    const regex = new RegExp(`(${prop})(?=:| \|)`, 'g'); // Match property titles and "At higher levels"
                    formattedContent = formattedContent.replace(regex, `<b>$1</b>`);
                });

                if (content.startsWith('rule')) {
                    const hr = document.createElement('hr');
                    card.appendChild(hr);
                } else if (content.startsWith('property') || content.startsWith('section')) {
                    element.className = 'property';
                    // Split and format properties, keeping the value part as is
                    const parts = formattedContent.split(' | ');
                    formattedContent = `${parts[1]} ${parts[2] || ''}`;
                    if (content.startsWith('section')){
                        const hr = document.createElement('hr');
                        card.appendChild(hr);
                    }
                } else if (content.startsWith('text') || content.startsWith('subtitle')) {
                    element.className = content.split(' | ')[0]; // 'text' or 'subtitle'
                    formattedContent = formattedContent.split(' | ')[1] || '';
                }

                element.innerHTML = formattedContent; // Use innerHTML to render the HTML tags
                if (!content.startsWith('rule')) {
                    card.appendChild(element);
                }
            });

            container.appendChild(card);
        });
    }


    function filterSpells() {
        const query = document.getElementById('searchInput').value.toLowerCase();
        const selectedLevels = Array.from(document.querySelectorAll('.levelFilter:checked')).map(cb => cb.value);

        const filteredSpells = spells.filter(spell => {
            const spellTitleMatch = spell.title.toLowerCase().includes(query);
            // Updated logic to handle cantrip level matching
            const spellLevelMatch = spell.tags.some(tag => {
                const tagLower = tag.toLowerCase();
                if (tagLower === "cantrips") return selectedLevels.includes("cantrips level");
                return selectedLevels.includes(tagLower);
            });
            return spellTitleMatch && (selectedLevels.length === 0 || spellLevelMatch);
        });

        renderCards(filteredSpells);
    }

    // Helper function to extract level from spell tags
    function getSpellLevel(tags) {
        for (const tag of tags) {
            const match = tag.match(/(\d+)(?:st|nd|rd|th) level|Cantrips/i);
            if (match) return match[0].toLowerCase(); // Return the matched level or 'cantrips'
        }
        return null; // Return null if no level is found
    }

    // Helper function to compare spell levels for sorting
    function compareSpellLevels(levelA, levelB) {
        if (levelA === 'cantrips') return -1; // Cantrips should always come first
        if (levelB === 'cantrips') return 1;
        const numLevelA = parseInt(levelA) || 0; // Parse numeric levels, default to 0 for cantrips
        const numLevelB = parseInt(levelB) || 0;
        return numLevelA - numLevelB; // Compare numeric levels
    }
    document.getElementById('searchInput').addEventListener('input', filterSpells);

    const levels = extractAndSortLevels(spells);
    createLevelCheckboxes(levels);

    document.querySelectorAll('.levelFilter').forEach(checkbox => {
        checkbox.addEventListener('change', filterSpells);
    });

    // Initial render
    renderCards(spells);
</script>
<script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', function() {
        navigator.serviceWorker.register('/service-worker.js').then(function(registration) {
          // Registration was successful
          console.log('ServiceWorker registration successful with scope: ', registration.scope);
        }, function(err) {
          // registration failed :(
          console.log('ServiceWorker registration failed: ', err);
        });
      });
    }
  </script>
</body>
</html>
